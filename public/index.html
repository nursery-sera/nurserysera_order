<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <base target="_top">
  <script>window.API_BASE='https://nurseryseraorder-production-89f1.up.railway.app/api';</script>
  <meta name="viewport" content="width=950, user-scalable=no">
  <title>nursery sera — ご注文フォーム</title>
  <link href="https://fonts.googleapis.com/css2?family=Bayon&family=Tangerine:wght@700&family=Italianno&display=swap" rel="stylesheet">
  <style>
    html,body{margin:0;padding:0;font-size:20px;-webkit-text-size-adjust:100%;font-family:Arial,sans-serif;background:#fff;color:#333;box-sizing:border-box;min-height:100vh;scroll-behavior:smooth}
    *,*:before,*:after{box-sizing:inherit}

    /* ===== ヘッダー（上部固定／線なし／スクロール追従なし） ===== */
    .header-bar{
      position:relative;
      background:#fff;
      display:flex; align-items:center; justify-content:center;
      padding:20px; border:none; box-shadow:none; outline:0;
    }
    .main-title{font-family:'Bayon',cursive;font-size:120px;margin:0;white-space:nowrap;user-select:none}

    /* 見出し */
    .subtitle-x{font-family:'Tangerine',cursive;font-size:100px;opacity:.6;margin-top:-30px;text-align:center;color:#555}
    .subtitle{font-family:'Tangerine',cursive;font-size:44px;opacity:1;margin:66px 0 -10px;text-align:center;color:#888;font-weight:300}

    /* 入力フォーム */
    form{width:100vw;padding:0 5vw}
    .form-group{position:relative;margin-top:48px}
    .form-group input,.form-group textarea,.form-group select{
      width:100%; padding:28px 12px 12px 12px; font-size:42px;
      border:none; border-bottom:2px solid #aaa; background:transparent; outline:none;
      font-weight:300; appearance:none; color:inherit; text-align:left; line-height:1.2;
    }
    .form-group textarea{min-height:6em;resize:vertical}

    /* 日付入力：他と完全統一＋青文字抑制 */
    input[type="date"]{
      -webkit-appearance:none; appearance:none;
      color:inherit; -webkit-text-fill-color:currentColor; font-weight:300;
      text-align:left; font-size:42px; line-height:inherit; padding:28px 12px 12px 12px;
      background:transparent;
    }
    input[type="date"]::-webkit-datetime-edit{color:inherit;padding:0;text-align:left}
    input[type="date"]::-webkit-date-and-time-value{text-align:left}
    input[type="date"]::-webkit-clear-button{display:none}
    input[type="date"]::-webkit-calendar-picker-indicator{opacity:.6}

    /* 選択肢の青色強制を抑える */
    select option{color:#333}
    select:focus, input[type="date"]:focus{color:inherit;-webkit-text-fill-color:currentColor}

    .form-group label{
      position:absolute; left:12px; top:22px; color:#888; background:inherit; padding:0 6px;
      transition:.2s ease; pointer-events:none; font-size:36px;
    }
    /* ラベル浮上（select/date は .has-value で補助） */
    .form-group input:focus + label,
    .form-group input:not(:placeholder-shown) + label,
    .form-group textarea:focus + label,
    .form-group textarea:not(:placeholder-shown) + label,
    .form-group select.has-value + label,
    .form-group select:focus + label,
    .form-group input[type="date"].has-value + label,
    .form-group input[type="date"]:focus + label{
      top:-16px; left:8px; font-size:28px; color:#444;
    }

    input::placeholder{opacity:0;transition:opacity .2s}
    input:focus::placeholder{opacity:1}
    .ph-on::placeholder{opacity:1!important}

    .row{display:flex;gap:16px}
    .row .form-group{flex:1;margin-top:48px}

    .zip-btn{opacity:.9;position:absolute;right:0;top:0;height:100%;font-size:36px;padding:0 20px;background:#fff;color:#888;border:2px solid #888;cursor:pointer;border-radius:0;font-weight:400;transform:translate(0,-2px)}

    .pref-wrap{position:relative}
    .pref-list{position:absolute;left:0;right:0;top:100%;background:#fff;border:1px solid #aaa;z-index:9999;max-height:280px;overflow:auto;display:none}
    .pref-list button{display:block;width:100%;text-align:left;background:#fff;border:0;padding:12px;font-size:32px;cursor:pointer;border-bottom:1px solid #eee}
    .pref-list button:hover{background:#f7f7f7}

    .submit-button{
      display:block;width:fit-content;margin:50px auto 120px;background:none;border:none;padding:0;font-size:52px;font-weight:200;color:#333;cursor:pointer;opacity:.8;
      text-decoration:none;border-bottom:1.4px solid currentColor;padding-bottom:6px
    }

    @media (min-width:1024px)){
      html{font-size:16px}
      .main-title{font-size:100px}
      .subtitle{font-size:20px}
      form{max-width:720px;margin:0 auto;padding:0 32px}
      .form-group input,.form-group textarea,.form-group select{font-size:16px;padding:12px 10px}
      .form-group label{font-size:14px;top:14px}
      .form-group input:focus + label,
      .form-group input:not(:placeholder-shown) + label,
      .form-group textarea:focus + label,
      .form-group textarea:not(:placeholder-shown) + label,
      .form-group select.has-value + label,
      .form-group select:focus + label,
      .form-group input[type="date"].has-value + label,
      .form-group input[type="date"]:focus + label{font-size:12px;top:-10px}
      .zip-btn{font-size:14px;padding:0 14px}
      .pref-list button{font-size:14px}
    }

    /* ===== モーダルカレンダー ===== */
    .cal-overlay{
      position:fixed; inset:0; background:rgba(0,0,0,.5);
      display:none; align-items:center; justify-content:center;
      z-index:99999;
    }
    .cal-dialog{
      background:#fff; width:96vw; max-width:1080px; border-radius:14px;
      box-shadow:0 14px 48px rgba(0,0,0,.35);
      padding:24px; transform:none;
    }
    .cal-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}
    .cal-title{font-size:38px;font-weight:700}
    .cal-nav button{
      font-size:32px;background:#fff;border:2px solid #ddd;padding:10px 18px;cursor:pointer;border-radius:8px
    }
    .cal-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:12px}
    .cal-dow{font-size:20px;text-align:center;opacity:.7}
    .cal-day{
      height:110px; display:flex; align-items:center; justify-content:center;
      border:2px solid #ddd; cursor:pointer; font-size:32px; user-select:none;
      border-radius:10px;
    }
    .cal-day:hover{background:#f5f5f5}
    .cal-day.disabled{opacity:.35;cursor:not-allowed;background:#fafafa}
    .cal-actions{display:flex;gap:16px;justify-content:flex-end;margin-top:18px}
    .cal-actions button{
      font-size:24px;background:#fff;border:2px solid #ddd;padding:12px 20px;cursor:pointer;border-radius:8px
    }
    .no-scroll{overflow:hidden}

    /* ---- 追加：時間帯 select のプレースホルダー風表示用 ---- */
    #timeSlot.hinting{color:#999;}
  </style>
</head>
<body>
  <div class="header-bar" id="titleBar" aria-label="nursery sera">
    <div class="main-title">nursery sera</div>
  </div>

  <p class="subtitle-x">order form</p>
  <p class="subtitle">配送先住所</p>

  <form id="contact-form">
    <div class="row">
      <div class="form-group">
        <input id="lastName" name="lastName" type="text" placeholder="姓" autocomplete="family-name" required>
        <label id="nameMasterLabel">お名前</label>
      </div>
      <div class="form-group">
        <input id="firstName" name="firstName" type="text" placeholder="名" autocomplete="given-name" required>
        <label></label>
      </div>
    </div>

    <div class="form-group">
      <input type="text" id="zipcode" name="zipcode" placeholder="例:1234567(ハイフンなし)" maxlength="7" required>
      <label>郵便番号</label>
      <button type="button" class="zip-btn" id="zipBtn">住所自動入力</button>
    </div>

    <div class="form-group pref-wrap">
      <input type="text" id="prefecture" name="prefecture" placeholder=" " required readonly>
      <label>都道府県</label>
      <div class="pref-list" id="prefList"></div>
    </div>

    <div class="form-group">
      <input type="text" id="city" name="city" placeholder=" " required>
      <label>市区町村</label>
    </div>

    <div class="form-group">
      <input type="text" id="address" name="address" placeholder=" ">
      <label>町名・番地</label>
    </div>

    <div class="form-group">
      <input type="text" id="building" name="building" placeholder=" ">
      <label>建物名・部屋番号</label>
    </div>

    <div class="form-group">
      <input type="tel" id="phone" name="phone" placeholder=" " required>
      <label>電話番号（ハイフンなし）</label>
    </div>

    <!-- 任意 -->
    <div class="form-group">
      <input type="email" id="email" name="email" placeholder=" " autocomplete="email">
      <label>連絡用メールアドレス（任意）</label>
    </div>

    <div class="form-group">
      <input type="text" id="instagram" name="instagram" placeholder=" ">
      <label>Instagramからご注文の方:アカウント名</label>
    </div>

    <div class="form-group">
      <input type="text" id="deliveryDate" name="deliveryDate" placeholder=" " readonly autocomplete="off" inputmode="none">
      <label>お届け希望日（未選択＝最短日）</label>
    </div>

    <div class="form-group">
      <select id="timeSlot" name="timeSlot">
        <option value="" selected hidden></option>
        <option value="08-12">午前中</option>
        <option value="14-16">14時～16時</option>
        <option value="16-18">16時～18時</option>
        <option value="18-20">18時～20時</option>
        <option value="19-21">19時～21時</option>
      </select>
      <label>ご希望配達時間（任意）</label>
    </div>

    <div class="form-group">
      <textarea id="memo" name="memo" placeholder=" "></textarea>
      <label>備考【任意】</label>
    </div>

    <button type="submit" id="submitBtn" class="submit-button" aria-busy="false">送信 ></button>
  </form>

  <!-- モーダルカレンダー -->
  <div class="cal-overlay" id="calOverlay" aria-modal="true" role="dialog">
    <div class="cal-dialog" role="document">
      <div class="cal-head">
        <div class="cal-title" id="calTitle">YYYY年 M月</div>
        <div class="cal-nav">
          <button type="button" id="calPrev" aria-label="前の月">‹</button>
          <button type="button" id="calNext" aria-label="次の月">›</button>
        </div>
      </div>
      <div class="cal-grid" id="calGrid"></div>
      <div class="cal-actions">
        <button type="button" id="calClose">閉じる</button>
        <button type="button" id="calClear">未選択にする</button>
      </div>
    </div>
  </div>

<script>
  /* ==== select / date のラベル状態（値あり→.has-value） ==== */
  (function(){
    function bindHasValue(el){
      if(!el) return;
      const apply=()=>{ el.classList[el.value ? 'add' : 'remove']('has-value'); };
      el.addEventListener('change',apply);
      el.addEventListener('blur',apply);
      apply();
    }
    bindHasValue(document.getElementById('timeSlot'));
    bindHasValue(document.getElementById('deliveryDate'));
  })();

  /* ==== 「ご希望配達時間」：タップ時だけプレースホルダー風に表示 → 選択で自動消去 ==== */
  (function(){
    const sel = document.getElementById('timeSlot');
    if(!sel) return;

    const HINT_VALUE = '__NEKO_HINT__';
    const HINT_TEXT  = 'ネコポスでは配達時間のご指定はできません';

    function ensureHintOption(){
      let opt = sel.querySelector('option[data-hint="1"]');
      if(!opt){
        opt = document.createElement('option');
        opt.value = HINT_VALUE;
        opt.textContent = HINT_TEXT;
        opt.dataset.hint = '1';
        opt.disabled = true;
      }
      return opt;
    }

    sel.addEventListener('focus', ()=>{
      // まだ何も選ばれていない時だけ、最上段に一時的に挿入して選択状態にする
      if (!sel.value){
        const hint = ensureHintOption();
        if (!hint.parentNode){
          sel.insertBefore(hint, sel.firstChild);
        }
        sel.value = HINT_VALUE;
        sel.classList.add('hinting');
      }
    });

    sel.addEventListener('change', ()=>{
      // ヒント以外を選んだらヒント項目を削除して通常表示へ
      if (sel.value !== HINT_VALUE){
        const hint = sel.querySelector('option[data-hint="1"]');
        if (hint) hint.remove();
        sel.classList.remove('hinting');
        // 値が入ったのでラベルを浮かせる（既存仕様と揃える）
        sel.classList.add('has-value');
      }
    });

    sel.addEventListener('blur', ()=>{
      // 何も選ばずフォーカスが外れたらヒントを消して未選択へ戻す
      if (sel.value === HINT_VALUE){
        const hint = sel.querySelector('option[data-hint="1"]');
        if (hint) hint.remove();
        sel.value = '';
        sel.classList.remove('hinting');
        sel.classList.remove('has-value');
      }
    });
  })();

  /* ==== お届け希望日：min=3日後, max=14日後 + ブラックアウト ==== */
  (function(){
    const el = document.getElementById('deliveryDate');
    if(!el) return;

    const BLACKOUTS = [ /* '2025-01-01' など */ ];
    const WEEKLY_CLOSED = [ /* 0=日曜 … 6=土曜 */ ];

    const toYMD = (d)=>[
      d.getFullYear(),
      String(d.getMonth()+1).padStart(2,'0'),
      String(d.getDate()).padStart(2,'0')
    ].join('-');

    const today = new Date();
    const minD = new Date(today); minD.setDate(minD.getDate()+3);
    const maxD = new Date(today); maxD.setDate(maxD.getDate()+14);

    el.min = toYMD(minD);
    el.max = toYMD(maxD);

    function isWeeklyClosed(d){ return WEEKLY_CLOSED.includes(d.getDay()); }
    function isBlackout(d){ return BLACKOUTS.includes(toYMD(d)); }
    function isOutOfRange(d){ return d < minD || d > maxD; }
    function isDisabled(d){ return isOutOfRange(d) || isWeeklyClosed(d) || isBlackout(d); }

    el.addEventListener('input', ()=>{
      if (!el.value) return;
      const d = new Date(el.value+'T00:00:00');
      if (isDisabled(d)){
        const msg =
          isOutOfRange(d) ? '選択できるのは3〜14日後です。' :
          isWeeklyClosed(d) ? '店休日のため選択できません。' :
          'この日は選択できません。';
        el.setCustomValidity(msg);
        alert(msg);
        el.value = '';
        el.classList.remove('has-value');
      } else {
        el.setCustomValidity('');
        el.classList.add('has-value');
      }
    });

    const help = document.createElement('div');
    help.style.fontSize = '14px';
    help.style.color = '#888';
    help.style.marginTop = '6px';

    const list = [];
    const tmp = new Date(minD);
    while (tmp <= maxD){
      if (isDisabled(tmp)) list.push(toYMD(tmp));
      tmp.setDate(tmp.getDate()+1);
    }
    if (list.length){
      help.textContent = '選べない日: ' + list.join(', ');
      el.parentElement.appendChild(help);
    }

    /* ===== モーダルカレンダー本体 ===== */
    const overlay = document.getElementById('calOverlay');
    const grid = document.getElementById('calGrid');
    const title = document.getElementById('calTitle');
    const btnPrev = document.getElementById('calPrev');
    const btnNext = document.getElementById('calNext');
    const btnClose = document.getElementById('calClose');
    const btnClear = document.getElementById('calClear');

    const DOW = ['日','月','火','水','木','金','土'];

    function renderDOW(){
      grid.innerHTML = '';
      DOW.forEach(w=>{
        const c=document.createElement('div');
        c.className='cal-dow';
        c.textContent=w;
        grid.appendChild(c);
      });
    }

    let view = new Date(minD.getFullYear(), minD.getMonth(), 1);

    function clampView(){
      const start = new Date(minD.getFullYear(), minD.getMonth(), 1);
      const end   = new Date(maxD.getFullYear(), maxD.getMonth(), 1);
      if(view < start) view = start;
      if(view > end)   view = end;
    }

    function renderBody(){
      clampView();
      title.textContent = `${view.getFullYear()}年 ${view.getMonth()+1}月`;

      const firstDay = new Date(view.getFullYear(), view.getMonth(), 1);
      const startIdx = firstDay.getDay();
      const daysInMonth = new Date(view.getFullYear(), view.getMonth()+1, 0).getDate();

      renderDOW();

      for(let i=0;i<startIdx;i++){
        const empty = document.createElement('div');
        grid.appendChild(empty);
      }

      for(let d=1; d<=daysInMonth; d++){
        const cell = document.createElement('button');
        cell.type='button';
        cell.className='cal-day';
        cell.textContent = String(d);

        const cur = new Date(view.getFullYear(), view.getMonth(), d);
        const ymd = toYMD(cur);

        if (isDisabled(cur)){
          cell.classList.add('disabled');
          cell.disabled = true;
        }else{
          cell.addEventListener('click', ()=>{
            el.value = ymd;
            el.dispatchEvent(new Event('input'));
            closeCal();
          });
        }

        grid.appendChild(cell);
      }
    }

    function openCal(){
      view = new Date(minD.getFullYear(), minD.getMonth(), 1);
      renderBody();
      overlay.style.display='flex';
      document.body.classList.add('no-scroll');
    }
    function closeCal(){
      overlay.style.display='none';
      document.body.classList.remove('no-scroll');
    }

    btnPrev.addEventListener('click', ()=>{ view = new Date(view.getFullYear(), view.getMonth()-1, 1); renderBody(); });
    btnNext.addEventListener('click', ()=>{ view = new Date(view.getFullYear(), view.getMonth()+1, 1); renderBody(); });
    btnClose.addEventListener('click', closeCal);
    btnClear.addEventListener('click', ()=>{ el.value=''; el.classList.remove('has-value'); closeCal(); });
    overlay.addEventListener('click', (e)=>{ if(e.target===overlay) closeCal(); });

    el.addEventListener('click', openCal);
    el.addEventListener('focus', openCal);
  })();

  /* ====== 郵便番号 → 住所 ====== */
  (function(){
    var prefInput=document.getElementById('prefecture');
    var prefList=document.getElementById('prefList');
    var zipBtn=document.getElementById('zipBtn');

    function setPrefecture(p){ if(prefInput) prefInput.value=p; }
    window.setPrefecture=setPrefecture;

    if(zipBtn){
      zipBtn.addEventListener('click',function(){
        var zipEl=document.getElementById('zipcode');
        var zip=(zipEl&&zipEl.value?zipEl.value:'').trim();
        if(!/^\d{7}$/.test(zip)){ alert('正しい7桁の郵便番号を入力してください'); return; }
        fetch('https://zipcloud.ibsnet.co.jp/api/search?zipcode='+zip)
          .then(function(r){ return r.json(); })
          .then(function(data){
            if(!data.results){ alert('住所が見つかりませんでした。'); return; }
            var r=data.results[0];
            setPrefecture(r.address1);
            var city=document.getElementById('city');
            var addr=document.getElementById('address');
            if(city) city.value=(r.address2||'');
            ifaddr = document.getElementById('address');
            if(addr) addr.value=(r.address3||'');
          })
          .catch(function(){ alert('検索エラー'); });
      });
    }

    var prefInput2=document.getElementById('prefecture');
    var prefList2=document.getElementById('prefList');
    var PREFS=["北海道","青森県","岩手県","宮城県","秋田県","山形県","福島県","茨城県","栃木県","群馬県","埼玉県","千葉県","東京都","神奈川県","新潟県","富山県","石川県","福井県","山梨県","長野県","岐阜県","静岡県","愛知県","三重県","滋賀県","京都府","大阪府","兵庫県","奈良県","和歌山県","鳥取県","島根県","岡山県","広島県","山口県","徳島県","香川県","愛媛県","高知県","福岡県","佐賀県","長崎県","熊本県","大分県","宮崎県","鹿児島県","沖縄県"];
    if(prefInput2&&prefList2){
      PREFS.forEach(function(p){
        var b=document.createElement('button'); b.type='button'; b.textContent=p;
        b.addEventListener('click',function(){ setPrefecture(p); hidePrefList(); });
        prefList2.appendChild(b);
      });
      function showPrefList(){ prefList2.style.display='block'; }
      function hidePrefList(){ prefList2.style.display='none'; }
      prefInput2.addEventListener('click',function(e){ e.stopPropagation(); (prefList2.style.display==='block'?hidePrefList():showPrefList()); });
      document.addEventListener('click',hidePrefList);
    }
  })();

  /* ====== 送信（APIへPOST） ====== */
  (function(){
    const API=(window.API_BASE||'')+'/orders';
    let submitting=false;
    async function postJsonWithTimeout(url,body,{timeoutMs=20000}={}){
      const ctrl=new AbortController(); const t=setTimeout(()=>ctrl.abort(new Error('timeout')),timeoutMs);
      try{
        const res=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json','Accept':'application/json'},body:JSON.stringify(body),cache:'no-store',keepalive:true,signal:ctrl.signal});
        const text=await res.text(); let data; try{ data=text?JSON.parse(text):null; }catch{ data={raw:text}; } return {ok:res.ok,status:res.status,data};
      } finally{ clearTimeout(t); }
    }
    function sanitize(str){ return String(str||'').replace(/\p{Cf}/gu,'').trim(); }

    var form=document.getElementById('contact-form'); if(!form) return;
    const submitBtn=document.getElementById('submitBtn');

    form.addEventListener('submit',async function(e){
      e.preventDefault(); if(submitting) return; submitting=true;

      const fd=new FormData(form);
      submitBtn.textContent='送信中…';
      submitBtn.setAttribute('aria-busy','true');
      submitBtn.disabled=true;

      const emailRaw=sanitize(fd.get('email'));
      const emailOk=!emailRaw || /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(emailRaw);
      if(!emailOk){ alert('メールアドレスの形式が正しくありません'); return cleanup(); }

      const customer={
        lastName:sanitize(fd.get('lastName')), firstName:sanitize(fd.get('firstName')),
        zipcode:sanitize(fd.get('zipcode')), prefecture:sanitize(fd.get('prefecture')),
        city:sanitize(fd.get('city')), address:sanitize(fd.get('address')), building:sanitize(fd.get('building')),
        phone:sanitize(fd.get('phone')), email:emailRaw||'',
        instagram:sanitize(fd.get('instagram')),
        name:(sanitize(fd.get('lastName'))+' '+sanitize(fd.get('firstName'))).trim(),
        addressFull:(sanitize(fd.get('prefecture'))+sanitize(fd.get('city'))+sanitize(fd.get('address'))+sanitize(fd.get('building'))).trim()
      };
      if(!customer.lastName||!customer.firstName){ alert('お名前（姓・名）を入力してください'); return cleanup(); }

      const deliveryDateRaw=sanitize(fd.get('deliveryDate'));
      const timeSlotRaw=sanitize(fd.get('timeSlot'));

      const payload={
        customer,
        note:sanitize(fd.get('memo')),
        summary:{ subtotal:0, shipping:0, shippingOptionText:'', total:0, paymentMethod:'bank_transfer' },
        delivery:{ desired_date:deliveryDateRaw||'', desired_time:timeSlotRaw||'' }
      };

      try{
        let r=await postJsonWithTimeout(API,payload,{timeoutMs:20000});
        if(!r.ok){
          const msg=r.data?.message||r.data?.error||r.data?.raw||'サーバーエラー';
          const reqId=r.data?.request_id?`\nrequest_id: ${r.data.request_id}`:'';
          throw new Error(`HTTP ${r.status}: ${msg}${reqId}`);
        }
        alert('送信が完了しました。ご注文ありがとうございます。');
        e.target.reset();
        document.getElementById('timeSlot')?.classList.remove('has-value');
        document.getElementById('deliveryDate')?.classList.remove('has-value');
      }catch(err){
        alert(`エラー：${err.message}\n\n送信先: ${API}`);
        console.error('order error',err);
      }finally{ cleanup(); }

      function cleanup(){
        submitBtn.textContent='送信 >';
        submitBtn.setAttribute('aria-busy','false');
        submitBtn.disabled=false;
        submitting=false;
      }
    });
  })();

  /* 「お名前」クリックで 姓/名 の両方に placeholder を出す */
  (function(){
    const ln = document.getElementById('lastName');
    const fn = document.getElementById('firstName');
    const label = document.getElementById('nameMasterLabel');
    if(!ln || !fn || !label) return;

    function showBothPH(){ ln.classList.add('ph-on'); fn.classList.add('ph-on'); }
    function hideBothPHIfNoneFocused(){
      if (document.activeElement !== ln && document.activeElement !== fn){
        ln.classList.remove('ph-on'); fn.classList.remove('ph-on');
      }
    }
    label.addEventListener('mousedown', (e)=>{ e.preventDefault(); showBothPH(); ln.focus(); });
    label.addEventListener('click', (e)=>{ e.preventDefault(); showBothPH(); ln.focus(); });
    ln.addEventListener('focus', showBothPH);
    fn.addEventListener('focus', showBothPH);
    ln.addEventListener('blur', ()=> setTimeout(hideBothPHIfNoneFocused, 0));
    fn.addEventListener('blur', ()=> setTimeout(hideBothPHIfNoneFocused, 0));
    ln.addEventListener('input', showBothPH);
    fn.addEventListener('input', showBothPH);
  })();
</script>
</body>
</html>